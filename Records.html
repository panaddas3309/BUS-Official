<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡∏•‡∏≤</title>
  <style>
    body {
      font-family: "Prompt", sans-serif;
      background: #f5f7fa;
      margin: 0;
      padding: 0;
      color: #333;
    }
    #loading {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      flex-direction: column;
    }
    .loader {
      border: 6px solid #f3f3f3;
      border-top: 6px solid #4CAF50;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin-bottom: 10px;
    }
    @keyframes spin {
      100% { transform: rotate(360deg); }
    }
    .dashboard {
      padding: 20px;
      max-width: 500px;
      margin: auto;
    }
    .profile {
      text-align: center;
      margin-bottom: 20px;
    }
    .profile-pic {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      border: 3px solid #4CAF50;
    }
    .greeting {
      font-size: 20px;
      margin-top: 10px;
      font-weight: bold;
    }
    .greeting-sub {
      color: #666;
      font-size: 14px;
      margin-bottom: 15px;
    }
    .card {
      background: white;
      border-radius: 15px;
      padding: 15px;
      margin-bottom: 20px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .card h3 {
      margin-top: 0;
      font-size: 18px;
      border-bottom: 2px solid #eee;
      padding-bottom: 8px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    table th, table td {
      padding: 8px;
      text-align: left;
      border-bottom: 1px solid #eee;
    }
    table th {
      background: #f9f9f9;
    }
  </style>
</head>
<body>
  <!-- Loader -->
  <div id="loading">
    <div class="loader"></div>
    <div id="loading-text">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
  </div>

  <!-- Dashboard -->
  <div class="dashboard" id="dashboard" style="display:none;"></div>

  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script>
    const LIFF_ID = "2007956727-rbZz9a0z"; // <<== ‡πÉ‡∏™‡πà LIFF ID
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzVP5tUUXDE6faaIl8GzsKKS2qS3BL5gd-PFNo9ts_t7CIi5xM4ekhjkIbscRYEJFaT/exec";

    const greetings = [
      "‡∏î‡∏µ‡πÉ‡∏à‡∏ó‡∏µ‡πà‡πÄ‡∏à‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ!", "‡∏™‡∏π‡πâ ‡πÜ ‡∏Å‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏Ñ‡∏£‡∏±‡∏ö!", "‡∏û‡∏±‡∏Å‡∏ö‡πâ‡∏≤‡∏á‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏ô‡∏∞ ‡πÅ‡∏ï‡πà‡∏´‡πâ‡∏≤‡∏°‡∏¢‡∏≠‡∏°‡πÅ‡∏û‡πâ!",
      "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Å‡πá‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏î‡∏µ‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö!", "‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏°‡∏≠!", "‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô!"
    ];

    async function init() {
      await liff.init({ liffId: LIFF_ID });
      if (!liff.isLoggedIn()) liff.login();

      const profile = await liff.getProfile();
      const userId = profile.userId;

      let res = await fetch(`${SCRIPT_URL}?lineUserId=${userId}`);
      let data = await res.json();

      const dashboard = document.getElementById("dashboard");
      const loader = document.getElementById("loading");
      const greet = greetings[Math.floor(Math.random() * greetings.length)];

      loader.style.display = "none";
      dashboard.style.display = "block";

      if (data.bound) {
        dashboard.innerHTML = `
          <div class="profile">
            <img src="${profile.pictureUrl}" class="profile-pic" alt="Profile">
            <div class="greeting">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏∏‡∏ì ${data.name}</div>
            <div class="greeting-sub">${greet}</div>
          </div>

          <!-- Card ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏•‡∏≤‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ -->
          <div class="card">
            <h3>üìå ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏•‡∏≤‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</h3>
            <table>
              <tr><th>‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th><td>${data.employeeId}</td></tr>
              <tr><th>‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô (AL)</th><td>${data.vacation}</td></tr>
              <tr><th>‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢ (SL)</th><td>${data.sick}</td></tr>
              <tr><th>‡∏•‡∏≤‡∏Å‡∏¥‡∏à (BL)</th><td>${data.personal}</td></tr>
              <tr><th>‡∏Ç‡∏≤‡∏î‡∏á‡∏≤‡∏ô (A)</th><td>${data.absent}</td></tr>
            </table>
          </div>

          <!-- Card ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏≤ -->
          <div class="card">
            <h3>üìñ ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏≤</h3>
            <table>
              <tr><th>‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th><td>${data.employeeId}</td></tr>
              <tr><th>‡∏ä‡∏∑‡πà‡∏≠ - ‡∏™‡∏Å‡∏∏‡∏•</th><td>${data.name}</td></tr>
              <tr><th>‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô (AL)</th><td>${data.recordAL}</td></tr>
              <tr><th>‡∏õ‡πà‡∏ß‡∏¢ (SL)</th><td>${data.recordSL}</td></tr>
              <tr><th>‡∏Å‡∏¥‡∏à (BL)</th><td>${data.recordBL}</td></tr>
              <tr><th>‡∏Ç‡∏≤‡∏î‡∏á‡∏≤‡∏ô (A)</th><td>${data.recordA}</td></tr>
            </table>
          </div>
        `;
      } else {
        dashboard.innerHTML = `
          <div class="profile">
            <img src="${profile.pictureUrl}" class="profile-pic" alt="Profile">
            <div class="greeting">‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ú‡∏π‡∏Å‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</div>
          </div>
        `;
      }
    }

    init();
  </script>
</body>
</html>
