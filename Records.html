<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡∏•‡∏≤</title>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">
<style>
  body {
    margin: 0;
    font-family: 'Prompt', sans-serif;
    background: linear-gradient(135deg, #74ebd5, #9face6);
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
  }
  .dashboard {
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.12);
    padding: 20px;
    width: 90%;
    max-width: 420px;
    text-align: center;
    animation: fadeIn 0.6s ease-in-out;
  }
  @keyframes fadeIn {
    from {opacity: 0; transform: translateY(8px);}
    to {opacity: 1; transform: translateY(0);}
  }
  .profile-pic {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    border: 2px solid #4CAF50;
    margin-bottom: 10px;
  }
  .greeting {
    font-size: 18px;
    font-weight: 500;
    color: #333;
    margin-bottom: 5px;
  }
  .greeting-sub {
    font-size: 14px;
    color: #666;
    margin-bottom: 15px;
  }
  .info-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 15px;
  }
  .info-table th, .info-table td {
    border: 1px solid #ddd;
    padding: 10px;
    width: 50%;
    text-align: center;
  }
  .info-table th {
    font-weight: normal;
    background: #f1f1f1;
    text-align: right;
    padding-right: 10px;
  }
  .tab-buttons {
    display: flex;
    justify-content: center;
    margin-bottom: 15px;
    gap: 10px;
  }
  .tab-button {
    padding: 8px 16px;
    border-radius: 20px;
    border: none;
    cursor: pointer;
    font-weight: 500;
    transition: 0.3s;
  }
  .tab-active {
    background-color: #fff;
    color: #007bff;
    box-shadow: 0 3px 8px rgba(0,0,0,0.15);
  }
  .tab-inactive {
    background-color: #eee;
    color: #888;
  }
  .leave-card {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #fff;
    padding: 12px 16px;
    border-radius: 16px;
    margin-bottom: 10px;
    box-shadow: 0 3px 8px rgba(0,0,0,0.08);
  }
  .leave-card span.emoji { font-size: 20px; margin-right: 8px; }
  .loader {
    border: 4px solid #f3f3f3;
    border-top: 4px solid #4CAF50;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    animation: spin 1s linear infinite;
    margin: 50px auto;
  }
  @keyframes spin {
    0% { transform: rotate(0deg);}
    100% { transform: rotate(360deg);}
  }
  #loading-text { font-size: 16px; color: #555; text-align: center; margin-top: 10px;}
</style>
</head>
<body>

<div id="loading">
  <div class="loader"></div>
  <div id="loading-text">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
</div>

<div class="dashboard" id="dashboard" style="display:none;"></div>

<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<script>
const LIFF_ID = "2007956727-rbZz9a0z"; // ‡πÉ‡∏™‡πà LIFF ID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxu4y_3K_4-X_PWckRF77PP-jOHHL8eZTVMyVSWtufO00O67iTyyXrkJa9nEm0bqJUv/exec";

const greetings = [
  "‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö!", "‡∏î‡∏µ‡πÉ‡∏à‡∏ó‡∏µ‡πà‡πÄ‡∏à‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ!", "‡∏™‡∏π‡πâ ‡πÜ ‡∏Å‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏Ñ‡∏£‡∏±‡∏ö!",
  "‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ!", "‡∏¢‡∏¥‡πâ‡∏°‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ!", "‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô!",
  "‡∏°‡∏≤‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏•‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏±‡∏ô!", "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Å‡πá‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏î‡∏µ‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö!", "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ß‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏û‡∏•‡∏±‡∏á‡∏ö‡∏ß‡∏Å‡∏Å‡∏±‡∏ô‡πÄ‡∏ñ‡∏≠‡∏∞!",
  "‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô ‡∏Ñ‡∏∏‡∏ì‡∏Å‡πá‡πÄ‡∏≠‡∏≤‡∏≠‡∏¢‡∏π‡πà!", "‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö!", "‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏°‡∏≠!",
  "‡∏°‡∏≤‡∏•‡∏∏‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö!", "‡∏û‡∏±‡∏Å‡∏ö‡πâ‡∏≤‡∏á‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏ô‡∏∞ ‡πÅ‡∏ï‡πà‡∏´‡πâ‡∏≤‡∏°‡∏¢‡∏≠‡∏°‡πÅ‡∏û‡πâ!", "‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πâ‡∏≤‡∏ß‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏Ñ‡∏£‡∏±‡∏ö!",
  "‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏≤‡∏à‡πÄ‡∏à‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢ ‡πÅ‡∏ï‡πà‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Å‡πà‡∏á‡∏û‡∏≠!", "‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏°‡πÄ‡∏¢‡∏≠‡∏∞ ‡πÜ ‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö!"
];

async function init() {
  await liff.init({ liffId: LIFF_ID });
  if (!liff.isLoggedIn()) liff.login();

  const profile = await liff.getProfile();
  const userId = profile.userId;

  const dashboard = document.getElementById("dashboard");
  const loader = document.getElementById("loading");

  let res = await fetch(`${SCRIPT_URL}?lineUserId=${userId}`);
  let data = await res.json();

  const greet = greetings[Math.floor(Math.random()*greetings.length)];

  loader.style.display = "none";
  dashboard.style.display = "block";

  if (data.bound) {
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á HTML Dashboard
    dashboard.innerHTML = `
      <img src="${profile.pictureUrl}" class="profile-pic" alt="Profile">
      <div class="greeting">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏∏‡∏ì ${data.name}</div>
      <div class="greeting-sub">${greet}</div>

      <div class="tab-buttons">
        <button class="tab-button tab-active" id="tabRemainBtn" onclick="showTab('remain')">‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏•‡∏≤‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</button>
        <button class="tab-button tab-inactive" id="tabUsedBtn" onclick="showTab('used')">‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</button>
      </div>

      <div id="remain" class="leave-content">
        <div class="leave-card"><div><span class="emoji">üå¥</span>‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô</div><div>${data.vacation} ‡∏ß‡∏±‡∏ô</div></div>
        <div class="leave-card"><div><span class="emoji">üìÑ</span>‡∏•‡∏≤‡∏Å‡∏¥‡∏à</div><div>${data.sick} ‡∏ß‡∏±‡∏ô</div></div>
        <div class="leave-card"><div><span class="emoji">ü§í</span>‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢</div><div>${data.personal} ‡∏ß‡∏±‡∏ô</div></div>
        <div class="leave-card"><div><span class="emoji">‚ùå</span>‡∏Ç‡∏≤‡∏î‡∏á‡∏≤‡∏ô</div><div>${data.absent} ‡∏ß‡∏±‡∏ô</div></div>
      </div>

      <div id="used" class="leave-content" style="display:none;">
        <div class="leave-card"><div><span class="emoji">üå¥</span>‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô</div><div>${data.records.vacation} ‡∏ß‡∏±‡∏ô</div></div>
        <div class="leave-card"><div><span class="emoji">üìÑ</span>‡∏•‡∏≤‡∏Å‡∏¥‡∏à</div><div>${data.records.sick} ‡∏ß‡∏±‡∏ô</div></div>
        <div class="leave-card"><div><span class="emoji">ü§í</span>‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢</div><div>${data.records.personal} ‡∏ß‡∏±‡∏ô</div></div>
        <div class="leave-card"><div><span class="emoji">‚ùå</span>‡∏Ç‡∏≤‡∏î‡∏á‡∏≤‡∏ô</div><div>${data.records.absent} ‡∏ß‡∏±‡∏ô</div></div>
      </div>
    `;
  } else {
    dashboard.innerHTML = `
      <img src="${profile.pictureUrl}" class="profile-pic" alt="Profile">
      <div class="greeting">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏∏‡∏ì ${profile.displayName} - ‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ú‡∏π‡∏Å‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</div>
      <button class="btn btn-leave" onclick="location.href='bind.html'">‡πÑ‡∏õ‡∏ú‡∏π‡∏Å‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</button>
    `;
  }
}

// Toggle Tabs
function showTab(tab) {
  const remain = document.getElementById("remain");
  const used = document.getElementById("used");
  const remainBtn = document.getElementById("tabRemainBtn");
  const usedBtn = document.getElementById("tabUsedBtn");

  if(tab==="remain"){
    remain.style.display = "block";
    used.style.display = "none";
    remainBtn.classList.add("tab-active");
    remainBtn.classList.remove("tab-inactive");
    usedBtn.classList.add("tab-inactive");
    usedBtn.classList.remove("tab-active");
  } else {
    remain.style.display = "none";
    used.style.display = "block";
    usedBtn.classList.add("tab-active");
    usedBtn.classList.remove("tab-inactive");
    remainBtn.classList.add("tab-inactive");
    remainBtn.classList.remove("tab-active");
  }
}

init();
</script>
</body>
</html>
